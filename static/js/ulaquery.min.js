(function(){window.D_M={dict_rows:[],dict_heads:[],dict_map_columns:{},dict_rsl_rows:[],dict_rsl_heads:[],token_list:{},token_selected:[],load_dict:async function(){try{const a=await fetch("ula_data/data_export/dictionary.ula.csv",{method:"GET",headers:{"Content-Type":"text/plain;charset=UTF-8"},cache:"default"});if(!a.ok)throw Error(`Erroe:${a.status} ${a.statusText}`);this.dict_rows=(await a.text()).trim().split("\n").map(b=>b.trim().split("|"));this.dict_heads=this.dict_rows[0];this.dict_map_columns=
this.dict_heads.map(b=>b.toLowerCase()).reduce((b,c,e)=>{b[c]=e;return b},{});this.dict_rows.shift();this.dictToResultSet()}catch(a){throw alert(`Errror:${"ula_data/data_export/dictionary.ula.csv"}\n ${a}`),a;}},dictToResultSet:function(){var a=this.dict_heads;const b=a.findIndex((d,f)=>20<f&&1==d.length),c=a.findIndex((d,f)=>f>b&&d.startsWith("LOC")),e=a.findIndex((d,f)=>f>c&&d.startsWith("DAT"));this.dict_rsl_heads=this.dict_heads.slice(0,8);this.dict_rsl_heads.push("MSD");this.dict_rsl_heads.push("SIGL.");
this.dict_rsl_heads.push("LOC.");this.dict_rsl_heads.push("DATE");a=d=>{var f=d.slice(0,8);f=Array.from(f);var g=d.slice(8,b);g=g.filter(h=>""!==h).join(",");f.push(g);g=d.slice(b,c);g=g.filter(h=>""!==h).join(",");f.push(g);g=d.slice(c,e);g=g.filter(h=>""!==h).join(",");f.push(g);g=d.slice(e);g=g.filter(h=>""!==h).join(",");f.push(g);return f};this.dict_rsl_rows=[];for(const d of this.dict_rows){const f=a(d);this.dict_rsl_rows.push(f)}},findIndnxFormakey:function(a){let b=-1;for(let c=0;c<this.dict_rows.length;c++)if(this.dict_rows[c][1]===
a){b=c;break}return b},findIndices:function(a){const b=(g,h)=>{if(""==g)return!0;g=g.replace(/([.*+?^=!:${}()|[\]/\\])/g,"\\$1").replace(/\\\*/g,".*").replace(/\\\?/g,".");return(new RegExp(`^${g}$`)).test(h)},c=[],e=this.dict_rows.length;for(let g=0;g<e;g++){const h=this.dict_rows[g].map(l=>l.toLowerCase());let k=!0;var d=a.forma[1];""!=d&&(k=b(d,h[a.forma[0]]));if(k&&(d=a.lemma[1],""!=d&&b(d,h[a.lemma[0]]),k&&(d=a.etimo[1],""!=d&&(k=b(d,h[a.etimo[0]])),k))){for(const l of a.sigls){d=l[1];var f=
h[l[0]];if(""!=d&&d!=f){k=!1;break}}if(k){for(const l of a.locts)if(d=l[1],f=h[l[0]],""!=d&&d!=f){k=!1;break}if(k){for(const l of a.datets)if(d=l[1],f=h[l[0]],""!=d&&d!=f){k=!1;break}if(k&&(d=a.functs[1],0<d.length&&(d.includes(h[a.functs[0]])||(k=!1)),k&&(d=a.langs[1],0<d.length&&(d.includes(h[a.langs[0]])||(k=!1)),k&&(d=a.dates[1],0<d.length&&(d.includes(h[a.dates[0]])||(k=!1)),k&&(d=a.pos[1],0<d.length&&(d.includes(h[a.pos[0]])||(k=!1)),k))))){d=a.msd_attrs;if(0<d.length)for(const l of d)if(!l[1].includes(h[l[0]])){k=
!1;break}k&&k&&c.push(g)}}}}}return c},findRsltRows:function(a){a=this.findIndices(a);const b=[];for(const c of a)b.push(this.dict_rsl_rows[c]);return b},findDictRows:function(a){a=this.findIndices(a);const b=[];for(const c of a)b.push(this.dict_rows[c]);return b},setQueryConditions:function(){var a={forma:[],lemma:[],etimo:[],sigls:[],locts:[],datets:[],functs:[],langs:[],dates:[],pos:[],msd_attrs:[]};a.forma=[0,VS.forma];a.lemma=[1,VS.lemma];a.etimo=[2,VS.etimo];var b=VS.sigl.sigls.length;let c=
[];for(var e=0;e<b;e++)c.push([e+26,VS.sigl.sigls[e]]);a.sigls=c;e=VS.sigl.locts.length;var d=26+b;c=[];for(b=0;b<e;b++)c.push([b+d,VS.sigl.locts[b]]);a.locts=c;b=VS.sigl.datets.length;e=d+e;c=[];for(d=0;d<b;d++)c.push([d+e,VS.sigl.datets[d]]);a.datets=c;a.functs=[7,VS.funct.functs];a.langs=[4,VS.lang_date.langs];a.dates=[5,VS.lang_date.dates];e=[];c=[];for(let f of VS.msd_attrs){f=f.map(h=>h.toLowerCase());d=f[0].split("_");b=d[0];d=d[1].toLowerCase();const g=f.slice(1);c.push([this.dict_map_columns[d],
g]);0>e.indexOf(b)&&e.push(b)}a.pos=[6,e];a.msd_attrs=c;a=JSON.stringify(a).toLowerCase();return JSON.parse(a)},load_token_csv:async function(a){a=`ula_data/data_export/${a}`;try{var b=await fetch(a,{method:"GET",headers:{"Content-Type":"text/plain;charset=UTF-8"},cache:"default"});if(!b.ok)throw Error(`Erroe:${b.status} ${b.statusText}`);const c=(await b.text()).trim().split("\n");c.push("##|##");b=[];const e=[];for(const d of c){const f=d.split("|")[1];"##"!==f?b.push(f):(e.push(b),b=[])}return e}catch(c){throw alert(`Errror:${a}\n ${c}`),
c;}},load_text_list:async function(){try{const a=await fetch("ula_data/data_export/token_list.txt",{method:"GET",headers:{"Content-Type":"text/plain;charset=UTF-8"},cache:"default"});if(!a.ok)throw Error(`Erroe:${a.status} ${a.statusText}`);return(await a.text()).trim().split("\n")}catch(a){throw alert(`Errror:${"ula_data/data_export/token_list.txt"}\n ${a}`),a;}},findContextIndices:function(a,b){return this.token_list[b].reduce((c,e,d)=>{-1<e.indexOf(a)&&c.push(d);return c},[])},findContextRows:function(a,
b){a=this.findContextIndices(a,b);b=this.token_list[b];const c=[];for(const e of a)a=b[e],a.unshift(`${e}`),c.push(a);return c},load_tokens:async function(){var a=await D_M.load_text_list();for(var b of a){a=await D_M.load_token_csv(b);const c=b.split(".").slice(0,2).join("_");this.token_list[c]=a}b=Object.keys(this.token_list);this.token_selected.push(b[0]);this.token_selected.push(b[2])}}}).call(this);const z_dict=11,g_dict="dict";
var DictForm={id:"dict_form.id",wind:null,openAll:function(){this.build(D_M.dict_rows);this.show()},openQuerySelected:function(a){this.build(a);this.show()},build:async function(a){var b=D_M.dict_heads;let c=UaJth();c.append('\n<div class="menu_wnd" >\n<ul>\n<li>\n<a class="tipb arrow" href="javascript:DictForm.scroll_top()">&#9650;\n<span class="tiptextb">Scroll Top</span>\n</a>\n</li>\n<li>\n<a class="tipb arrow" href="javascript:DictForm.scroll_bottom()">&#9660;\n<span class="tiptextb">Scroll Bottom</span>\n</a>\n</li>\n<li>\n<a class="tipb arrow" href="javascript:DictForm.scroll_left()">&#9664;\n<span class="tiptextb">Scroll Left</span>\n</a>\n</li>\n<li>\n<a class="tipb arrow" href="javascript:DictForm.scroll_right()">&#9654;\n<span class="tiptextb">Scroll Right</span>\n</a>\n</li>\n\n<li>\n<a class="cmd" href="#">?\n</a>\n</li>\n<li>         </li>\n<li><a  href="javascript:DictForm.hide()">X</a></li>\n<li></li>\n</ul>\n</div>\n<div class="dict_form">\n');var e=
b.slice(0,8);b=b.slice(8);c.append("<table><thead><tr>");var d=k=>`<th><span>${k}</span></th>`;c.append(d,"N.");for(var f of e)c.append(d,f.toUpperCase());for(var g of b)c.append(d,g.toUpperCase());c.append("</tr></thead><tbody>");e=a.length;f=k=>`<td>${k}</td>`;g=k=>`<td class="m">${k}</td>`;b=0<a.length?a[0].length:0;for(d=0;d<e;d++){const k=a[d];c.append("<tr>");c.append(f,d);for(var h=0;8>h;h++)c.append(f,k[h]);for(h=8;h<b;h++)c.append(g,k[h]);c.append("</tr>")}c.append("</tbody></table></div>");
a=c.html();this.wind||(this.wind=UaWindowAdm.create(this.id,"ulaquery_id"),this.setXY(),this.wind.drag(),this.wind.addGroup(g_dict),this.wind.setZ(z_dict));this.wind.hide();this.wind.setHtml(a);this.bind()},show:async function(a){this.wind&&(wait_start(),await sleep(10),this.wind.show(),wait_stop())},hide:function(){this.wind&&this.wind.hide()},setXY:function(){this.wind.setXY(5,35,-1)},resetXY:function(){this.wind.reset();this.setXY();this.show()},scroll_top:function(){this.wind.w.querySelector("div.dict_form").scrollTop=
0},scroll_bottom:function(){const a=this.wind.w.querySelector("div.dict_form");a.scrollTop=a.scrollHeight},scroll_left:function(){this.wind.w.querySelector("div.dict_form").scrollLeft=0},scroll_right:function(){const a=this.wind.w.querySelector("div.dict_form");a.scrollLeft=a.scrollWidth},bind:function(){this.wind.w.querySelector("div.dict_form").addEventListener("click",a=>{a.preventDefault();a.stopImmediatePropagation();for(a=a.target;a&&"TR"!==a.tagName;)a=a.parentNode;a=a.querySelectorAll("td")[2].innerHTML;
ContextMgr.openSelected(a)})}};const filter_group="filter",top_filter=35,where_top=top_filter+380,where_left=5,z_where=10,form_lemma_top=top_filter,form_lemma_left=3,z_form_lemma=9,sigl_top=top_filter+130,sigl_left=5,z_sigl=8,funct_top=top_filter,funct_left=490,z_funct=7,lang_date_top=top_filter,lang_date_left=300,z_lang_date=6,pos_msd_top=top_filter,pos_msd_left=670,z_pos_msd=5,VS={forma:"",lemma:"",etimo:"",sigl:{sigls:[],locts:[],datets:[]},funct:{functs:[]},lang_date:{langs:[],dates:[]},msd_attrs:[],select:function(){VS.forma=
FormLemma.forma;VS.lemma=FormLemma.lemma;VS.etimo=FormLemma.etimo;VS.sigl.sigls=Sigl.sigls;VS.sigl.locts=Sigl.locts;VS.sigl.datets=Sigl.datets;VS.funct.functs=Funct.functs;VS.lang_date.langs=LangDate.langs;VS.lang_date.dates=LangDate.dates;VS.msd_attrs=PosMsd.msd_attrs},unselect:function(){this.etimo=this.lemma=this.forma="";this.sigl.sigls=[];this.sigl.locts=[];this.sigl.datets=[];this.funct.functs=[];this.lang_date.langs=[];this.lang_date.dates=[];this.msd_attrs=[]}};
var FLT={visible:!1,open:function(){this.visible=!0;FormLemma.open();Funct.open();LangDate.open();Sigl.open();PosMsd.open();Where.open()},show:function(){this.visible=!0;FormLemma.show();Funct.show();LangDate.show();Sigl.show();PosMsd.show();Where.show()},hide:function(){this.visible=!1;FormLemma.hide();Funct.hide();LangDate.hide();Sigl.hide();PosMsd.hide();Where.hide()},resetXY:function(){this.visible=!0;FormLemma.resetXY();Sigl.resetXY();Funct.resetXY();LangDate.resetXY();PosMsd.resetXY();Where.resetXY()},
getAllSelected:function(){FormLemma.select();Sigl.select();Funct.select();LangDate.select();PosMsd.select();VS.select()},select:function(){this.getAllSelected();Where.build();Where.show()},unselect:function(){FormLemma.unselect();Sigl.unselect();Funct.unselect();LangDate.unselect();PosMsd.unselect();VS.unselect();Where.build();Where.show()},queryRslt:function(){this.getAllSelected();var a=D_M.setQueryConditions();a=D_M.findRsltRows(a);ResultSet.openQuerySelected(a)},queryDict:function(){this.getAllSelected();
var a=D_M.setQueryConditions();a=D_M.findDictRows(a);DictForm.openQuerySelected(a)}},Where={id:"Where_id",wind:null,isActive:!1,build:function(){var a=UaJth();a.append('\n<div class="menu_wnd">\n<ul>\n<li><a onclick="Where.testQuery()" href="#">Test</a></li>  \n<li><a onclick="Where.close()" href="#">X</a></li>  \n</ul>\n </div>\n');a.append('<div class="where"><ul>');a.append('\n    <li>\n    <div class="sl" >Select</div>\n    <div class="sv num"></div>\n    </li>');var b=(g,h)=>`
    <li>
    <div class="l" >${g}</div>
    <div class="v"><div>${h}</div></div>
    </li>`;a.append(b("Forma",VS.forma));a.append(b("Lemma",VS.lemma));a.append(b("Etimo",VS.etimo));const c=UaJth();b=g=>{c.reset();for(const h of g)c.append(`<div>${h}</div>`);return c.html()};const e=(g,h)=>`
    <li>
    <div class="l" >${g}</div>
    <div class="v">${h}</div>
    </li>`;var d=b(VS.sigl.sigls);a.append(e("Sigl",d));d=b(VS.sigl.locts);a.append(e("Loc.",d));d=b(VS.sigl.datets);a.append(e("Date",d));d=b(VS.funct.functs);a.append(e("Funct",d));d=b(VS.lang_date.langs);a.append(e("Lang.",d));d=b(VS.lang_date.dates);a.append(e("Date",d));for(let g in VS.msd_attrs){var f=VS.msd_attrs[g];d=f[0];f=f.slice(1);f=b(f);a.append(e(d,f))}a.append("</ul></div>");a=a.html();this.wind||(this.wind=UaWindowAdm.create(this.id,"ulaquery_id"),this.setXY(),this.wind.drag(),this.wind.setZ(z_where),
this.wind.addGroup(filter_group));this.wind.hide();this.wind.setHtml(a)},close:function(){this.wind&&(this.wind.hide(),this.isActive=!1)},open:function(){this.wind&&(this.wind.show(),this.isActive=!0)},show:function(a){this.wind&&this.isActive&&this.wind.show()},hide:function(){this.wind&&this.isActive&&this.wind.hide()},setXY:function(){this.wind.setXY(where_left,where_top,-1)},resetXY:function(){this.wind.reset();this.setXY();this.open()},testQuery:function(){FLT.getAllSelected();var a=D_M.setQueryConditions();
a=D_M.findIndices(a).length;this.wind.w.querySelector("div.where li div.num").innerHTML=`${a}`}},FormLemma={id:"form_lemma_id",wind:null,forma:"",lemma:"",etimo:"",isActive:!1,build:async function(){var a=UaJth();a.append('\n    <div class="menu_wnd">\n    <ul>\n    <li>\n    <a class="tipb" onclick="FormLemma.unselect()" href="#">Unselect\n       <span class="tiptextb">Reset Fields Selected</span>\n     </a>\n    </li>\n    <li><a  onclick="FormLemma.close()" href="#">X</a></li>  \n    </ul>\n    </div>\n    \n<div class="form_lemma">\n<ul>\n<li>\n  <div class="l">Forma</div>:\n  <div  class="i"> <input type="text" value="" name="forma" size="6" > </div>\n</li>\n<li>\n  <div class="l">Lemma</div>:\n  <div class="i"> <input type="text" value="" name="lemma" size="6" > </div>\n</li>\n<li>\n  <div class="l">Etimo</div>:\n  <div class="i"> <input type="text" value="" name="etimo" size="6" > </div> \n</li>\n</ul>\n</div>\n       ');
a=a.html();this.wind||(this.wind=UaWindowAdm.create(this.id,"ulaquery_id"),this.setXY(),this.wind.drag(),this.wind.setZ(z_form_lemma),this.wind.addGroup(filter_group));this.wind.setHtml(a);this.bind()},close:function(){this.wind&&(this.wind.hide(),this.isActive=!1)},open:function(){this.wind&&(this.wind.show(),this.isActive=!0)},show:function(a){this.wind&&this.isActive&&this.wind.show()},hide:function(){this.wind&&this.isActive&&this.wind.hide()},setXY:function(){this.wind.setXY(form_lemma_left,
top_filter,-1)},resetXY:function(){this.wind.reset();this.setXY();this.open()},unselect:function(){const a=this.wind.w.querySelectorAll("div.form_lemma input");for(let b of a)b.value="";FLT.select()},select:function(){let a=this.wind.w.querySelector("div.form_lemma");this.forma=a.querySelector('input[name="forma"]').value;this.lemma=a.querySelector('input[name="lemma"]').value;this.etimo=a.querySelector('input[name="etimo"]').value},bind:function(){const a=this.wind.w.querySelectorAll("div.form_lemma input");
for(let b of a)b.addEventListener("change",c=>{FLT.select()}),b.addEventListener("mouseleave",c=>{FLT.select()})}},Sigl={id:"sigl_id",wind:null,sigls:[],locts:[],datets:[],isActive:!1,load:async function(a){try{const b=await fetch(a,{method:"GET",headers:{"Content-Type":"text/plain;charset=UTF-8"},cache:"default"});if(!b.ok)throw Error(`Erroe:${b.status} ${b.statusText}`);return(await b.text()).trim().split("\n").map(c=>c.trim().split("|"))}catch(b){throw alert(`Errror:${a}\n ${b}`),b;}},build:async function(){var a=
UaJth();const b=await this.load("static/cfg/exp_loc_dat.csv"),c=[],e=[],d=[];for(const f of b)c.push(f[0]),e.push(f[2]),0>d.indexOf(f[3])&&d.push(f[3]);a.append('\n    <div class="menu_wnd">\n    <ul>\n    <li>\n    <a class="tipb" onclick="Sigl.unselect()" href="#">Unselect\n       <span class="tiptextb">Unselect Field Selected</span>\n     </a>\n    </li>\n    <li><a onclick="Sigl.close()" href="#">X</a></li>  \n    </ul>\n    </div>\n    <div class="sigl">');a.append("<div><ul>");a.append('<li class="s"><span>Sigl.</span></li> ');
for(let f of c)a.append(`<li class="s"><a>${f}</a></li> `);a.append("</ul></div>");a.append("<div><ul>");a.append('<li class="l"><span>Loc.T.</span></li> ');for(let f of e)a.append(`<li class="l"><a>${f}</a></li> `);a.append("</ul></div>");a.append("<div><ul>");a.append('<li class="d"><span>Date T.</span></li> ');for(let f of d)a.append(`<li class="d"><a>${f}</a></li> `);a.append("</ul></div>");a.append("</div>");a=a.html();this.wind||(this.wind=UaWindowAdm.create(this.id,"ulaquery_id"),this.setXY(),
this.wind.drag(),this.wind.setZ(z_sigl),this.wind.addGroup(filter_group));this.wind.setHtml(a);this.bind()},close:function(){this.wind&&(this.wind.hide(),this.isActive=!1)},open:function(){this.wind&&(this.wind.show(),this.isActive=!0)},show:function(a){this.wind&&this.isActive&&this.wind.show()},hide:function(){this.wind&&this.isActive&&this.wind.hide()},setXY:function(){this.wind.setXY(sigl_left,sigl_top,-1)},resetXY:function(){this.wind.reset();this.setXY();this.open()},bind:function(){const a=
this.wind.w.querySelectorAll("div.sigl li a");for(let b of a)b.addEventListener("click",c=>{c.preventDefault();c.stopImmediatePropagation();c=c.target;c.classList.contains("select")?c.classList.remove("select"):c.classList.add("select");FLT.select()})},unselect:function(){const a=this.wind.w.querySelectorAll("div.sigl li a");for(let b of a)b.classList.remove("select");FLT.select()},select:function(){const a=(d,f)=>{var g=Array.from(d);d=g.map(h=>h.innerHTML);g=Array(g.length).fill("");for(let h=0;h<
d.length;h++)f.includes(d[h])&&(g[h]=d[h]);return g},b=d=>Array.from(d).filter(f=>f.classList.contains("select")).map(f=>f.innerHTML);let c=this.wind.w.querySelectorAll("div.sigl li.s a"),e=b(c);this.sigls=a(c,e);c=this.wind.w.querySelectorAll("div.sigl li.l a");e=b(c);this.locts=a(c,e);c=this.wind.w.querySelectorAll("div.sigl li.d a");e=b(c);this.datets=a(c,e)}},Funct={id:"funct_id",wind:null,functs:[],isActive:!1,load:async function(a){try{const b=await fetch(a,{method:"GET",headers:{"Content-Type":"text/plain;charset=UTF-8"},
cache:"default"});if(!b.ok)throw Error(`Erroe:${b.status} ${b.statusText}`);return(await b.text()).trim().split("\n").filter(c=>"-"!=c)}catch(b){throw alert(`Errror:${a}\n ${b}`),b;}},build:async function(){var a=UaJth();const b=await this.load("static/cfg/funct.csv");a.append('\n    <div class="menu_wnd">\n    <ul>\n    <li>\n    <a class="tipb" onclick="Funct.unselect()" href="#">Unselect\n       <span class="tiptextb">Unselect Fields Selected</span>  </a>\n    </li>\n    <li><a onclick="Funct.close()"  href="#">X</a></li>  \n    </ul>\n    </div>\n    <div class="funct">');
a.append("<div><ul>");a.append('<li class="f"><span>Func</span></li> ');for(let c of b)a.append(`<li class="f"><a>${c}</a></li> `);a.append("</ul></div>");a.append("</div>");a=a.html();this.wind||(this.wind=UaWindowAdm.create(this.id,"ulaquery_id"),this.setXY(),this.wind.drag(),this.wind.setZ(z_funct),this.wind.addGroup(filter_group));this.wind.setHtml(a);this.bind()},close:function(){this.wind&&(this.wind.hide(),this.isActive=!1)},open:function(){this.wind&&(this.wind.show(),this.isActive=!0)},show:function(a){this.wind&&
this.isActive&&this.wind.show()},hide:function(){this.wind&&this.isActive&&this.wind.hide()},setXY:function(){this.wind.setXY(funct_left,top_filter,-1)},resetXY:function(){this.wind.reset();this.setXY();this.open()},bind:function(){const a=this.wind.w.querySelectorAll("div.funct li a");for(let b of a)b.addEventListener("click",c=>{c.preventDefault();c.stopImmediatePropagation();c=c.target;c.classList.contains("select")?c.classList.remove("select"):c.classList.add("select");FLT.select()})},unselect:function(){const a=
this.wind.w.querySelectorAll("div.funct li a");for(let b of a)b.classList.remove("select");FLT.select()},select:function(){this.functs=(a=>Array.from(a).filter(b=>b.classList.contains("select")).map(b=>b.innerHTML))(this.wind.w.querySelectorAll("div.funct li.f a"))}},LangDate={id:"langdate_id",wind:null,langs:[],dates:[],isActive:!1,load:async function(a){try{const b=await fetch(a,{method:"GET",headers:{"Content-Type":"text/plain;charset=UTF-8"},cache:"default"});if(!b.ok)throw Error(`Erroe:${b.status} ${b.statusText}`);
return(await b.text()).trim().split("\n").filter(c=>"-"!=c)}catch(b){throw alert(`Errror:${a}\n ${b}`),b;}},build:async function(){var a=UaJth();const b=await this.load("static/cfg/lang.csv"),c=await this.load("static/cfg/ldata.csv");a.append('\n    <div class="menu_wnd">\n    <ul>\n    <li>\n    <a class="tipb" onclick="LangDate.unselect()" href="#">Unselect\n       <span class="tiptextb">Unselect Fields Selected</span>  </a>\n    </li>\n    <li><a onclick="LangDate.close()"  href="#">X</a></li>  \n    </ul>\n    </div>\n    <div class="lang_date">');
a.append("<div><ul>");a.append('<li class="l"><span>Lang</span></li> ');for(let e of b)a.append(`<li class="l"><a>${e}</a></li> `);a.append("</ul></div>");a.append("<div><ul>");a.append('<li class="d"><span>Date</span></li> ');for(let e of c)a.append(`<li class="d"><a>${e}</a></li> `);a.append("</ul></div>");a.append("</div>");a=a.html();this.wind||(this.wind=UaWindowAdm.create(this.id,"ulaquery_id"),this.setXY(),this.wind.drag(),this.wind.setZ(z_lang_date),this.wind.addGroup(filter_group));this.wind.setHtml(a);
this.bind()},close:function(){this.wind&&(this.wind.hide(),this.isActive=!1)},open:function(){this.wind&&(this.wind.show(),this.isActive=!0)},show:function(a){this.wind&&this.isActive&&this.wind.show()},hide:function(){this.wind&&this.isActive&&this.wind.hide()},setXY:function(){this.wind.setXY(lang_date_left,top_filter,-1)},resetXY:function(){this.wind.reset();this.setXY();this.open()},bind:function(){const a=this.wind.w.querySelectorAll("div.lang_date li a");for(let b of a)b.addEventListener("click",
c=>{c.preventDefault();c.stopImmediatePropagation();c=c.target;c.classList.contains("select")?c.classList.remove("select"):c.classList.add("select");FLT.select()})},unselect:function(){const a=this.wind.w.querySelectorAll("div.lang_date li a");for(let b of a)b.classList.remove("select");FLT.select()},select:function(){const a=c=>Array.from(c).filter(e=>e.classList.contains("select")).map(e=>e.innerHTML);let b=this.wind.w.querySelectorAll("div.lang_date li.l a");this.langs=a(b);b=this.wind.w.querySelectorAll("div.lang_date li.d a");
this.dates=a(b)}},PosMsd={id:"pos_msd_id",isActive:!1,wind:null,msd_attrs:{},load:async function(){try{const a=await fetch("static/cfg/pos_msd.csv",{method:"GET",headers:{"Content-Type":"text/plain;charset=UTF-8"},cache:"default"});if(!a.ok)throw Error(`Erroe:${a.status} ${a.statusText}`);return(await a.text()).trim().split("\n").map(b=>b.split("|"))}catch(a){throw alert(`Errror:${"static/cfg/pos_msd.csv"}\n ${a}`),a;}},build:async function(){var a=await this.load();a.shift();var b=UaJth();const c=
UaJth();c.append('\n    <div class="menu_wnd">\n    <ul>\n    <li>\n    <a class="tipb" onclick="PosMsd.unselect()" href="#">nselect\n       <span class="tiptextb">Unselect Fields Selected</span>\n     </a>\n    </li>\n    <li><a onclick="PosMsd.close()"  href="#">X</a></li>  \n    </ul>\n    </div>\n    <div class="pos_msd">\n    <ul class="pos">');let e="XX";for(let d of a){if(""==d[3].trim())continue;a=d[3].split(",");const f=d[2];b.reset();b.append("<li><div><ul>");d[0]!=e?(e=d[0],b.append(`<li class="p"><span>${e}</span></li>`)):
b.append('<li class="e"></li>');b.append(`<li class="m"><span>${f}</span></li>`);for(let g of a)b.append(`<li class="a"><a>${g}</a></li>`);b.append("</ul></div></li>");a=b.html();c.append(`${a}`)}c.append("</ul></div>");b=c.html();this.wind||(this.wind=UaWindowAdm.create(this.id,"ulaquery_id"),this.setXY(),this.wind.drag(),this.wind.setZ(z_pos_msd),this.wind.addGroup(filter_group));this.wind.setHtml(b);this.bind()},close:function(){this.wind&&(this.wind.hide(),this.isActive=!1)},open:function(){this.wind&&
(this.wind.show(),this.isActive=!0)},show:function(a){this.wind&&this.isActive&&this.wind.show()},hide:function(){this.wind&&this.isActive&&this.wind.hide()},setXY:function(){this.wind.setXY(pos_msd_left,top_filter,-1)},resetXY:function(){this.wind.reset();this.setXY();this.open()},bind:function(){const a=this.wind.w.querySelectorAll("div.pos_msd li.a a");for(let b of a)b.addEventListener("click",c=>{c.preventDefault();c.stopImmediatePropagation();c=c.currentTarget;c.classList.contains("select")?
c.classList.remove("select"):c.classList.add("select");FLT.select()})},select:function(){const a=[];var b=Array.from(this.wind.w.querySelectorAll("div.pos_msd li.m"));let c="";for(const d of b){var e=d.parentElement;if(b=e.querySelector("li.p span"))c=b.innerHTML;b=d.querySelector("span").innerHTML;const f=Array.from(e.querySelectorAll("li.a a.select"));e=[];for(const g of f)e.push(g.innerHTML);0<e.length&&(b=`${c.toLowerCase()}_${b}`,e.unshift(b),a.push(e))}this.msd_attrs=a},unselect:function(){const a=
this.wind.w.querySelectorAll("div.pos_msd li.a a");for(let b of a)b.classList.remove("select");FLT.select()}};const result_set_top=35,result_set_left=5,z_result_set=11,g_result_set="resultset";
var ResultSet={id:"resultset_id",wind:null,openAll:function(){this.build(D_M.dict_rsl_rows);this.show()},openQuerySelected:function(a){this.build(a);this.show()},build:async function(a){let b=UaJth();b.append('\n<div class="menu_wnd" >\n<ul>\n<li>\n<a class="tipb arrow" href="javascript:ResultSet.scroll_top()">&#9650;\n<span class="tiptextb">Scroll Top</span>\n</a>\n</li>\n<li>\n<a class="tipb arrow" href="javascript:ResultSet.scroll_bottom()">&#9660;\n<span class="tiptextb">Scroll Bottom</span>\n</a>\n</li>\n<li>\n<a class="tipb arrow" href="javascript:ResultSet.scroll_left()">&#9664;\n<span class="tiptextb">Scroll Left</span>\n</a>\n</li>\n<li>\n<a class="tipb arrow" href="javascript:ResultSet.scroll_right()">&#9654;\n<span class="tiptextb">Scroll Right</span>\n</a>\n</li>\n\n<li>\n<a class="cmd" href="#">?\n</a>\n</li>\n<li>         </li>\n<li><a href="javascript:ResultSet.hide()">X</a></li>\n<li></li>\n</ul>\n</div>\n<div class="resultset">\n');var c=
D_M.dict_rsl_heads;b.append("<table><thead><tr>");var e=f=>`<th><span>${f}</span></th>`;b.append(e,"N.");for(var d of c)b.append(e,d.toUpperCase());b.append("</tr></thead><tbody>");c=f=>`<td>${f}</td>`;e=a.length;for(d=0;d<e;d++){const f=a[d];b.append("<tr>");b.append(c,d);for(const g of f)b.append(c,g);b.append("</tr>")}b.append("</tbody></table></div>");a=b.html();this.wind||(this.wind=UaWindowAdm.create(this.id,"ulaquery_id"),this.setXY(),this.wind.drag(),this.wind.addGroup(g_result_set),this.wind.setZ(z_result_set));
this.wind.hide();this.wind.setHtml(a);this.bind()},show:async function(a){this.wind&&(wait_start(),await sleep(10),this.wind.show(),wait_stop())},hide:function(){this.wind&&(this.wind.hide(),FLT.visible&&FLT.show())},setXY:function(){this.wind.setXY(result_set_left,result_set_top,-1)},resetXY:function(){this.wind.reset();this.setXY();this.show()},scroll_top:function(){this.wind.w.querySelector("div.resultset").scrollTop=0},scroll_bottom:function(){const a=this.wind.w.querySelector("div.resultset");
a.scrollTop=a.scrollHeight},scroll_left:function(){this.wind.w.querySelector("div.resultset").scrollLeft=0},scroll_right:function(){const a=this.wind.w.querySelector("div.resultset");a.scrollLeft=a.scrollWidth},bind:function(){this.wind.w.querySelector("div.resultset").addEventListener("click",a=>{a.preventDefault();a.stopImmediatePropagation();for(a=a.target;a&&"TR"!==a.tagName;)a=a.parentNode;a=a.querySelectorAll("td")[2].innerHTML;ContextMgr.openSelected(a)})}};const punctuationRegex=/[!"#$%&'()*+,-./:;<=>?@[\]^_`{|}~]/,g_text="text",g_context="context",g_select_text="selecttext",g_form_rows="formrows",z_text0=11,z_context0=12,z_select_text=9200,z_form_rows=9110,form_rows_top=35,form_rows_left=50;
var TextMgr={names:[],objs:{},createObjs:async function(){var a=Object.keys(D_M.token_list);let b=0,c=z_text0;for(const e of a)a=this.new(e,b,30,c),this.objs[e]=a,this.names.push(e),b+=200,c+=1},open:function(a){alert("opern")},openSelected:function(){var a=Object.keys(D_M.token_list);let b=D_M.token_selected;0==b.length&&SelectText.open();for(const c of a)a=this.objs[c],-1<b.indexOf(c)?a.open():a.hide()},closeAll:function(){const a=Object.values(this.objs);for(const b of a)b.hide()},relocateAll:function(){let a=
D_M.token_selected;for(const b of a)this.objs[b].resetXY()},new:function(a,b,c,e){return{id:`${a}text_id`,name:a,wind:null,text_rows:[],open:function(){this.text_rows=D_M.token_list[this.name];this.build();this.show()},build:function(){var d=UaJth();d.append('\n<div class="menu_wnd" >\n<ul>\n\n<li><a class="tipb arrow" cmd="top" href="#" >&#9650;\n<span class="tiptextb">Scroll Top</span></a>\n</li>\n\n<li><a class="tipb arrow" cmd="bottom" href="#" >&#9660;\n<span class="tiptextb">Scroll Bottom</span></a>\n</li>\n\n<li><a class="tipb" cmd="unselect" href="#">Unselect\n<span class="tiptextb">Close and Unselect Text</span> </a>\n</li> \n\n<li><a href="#" cmd="close">X</a></li> </ul>\n</div>\n<div class="text">\n  ');
d.append(`<div class='h'>${a}</div> `);let f=(h,k)=>`
<div class='row'>
   <span class='n' >${h}</span>
   <span class='text'>${k}</span>
</div>
`;const g=this.text_rows.length;for(let h=0;h<g;h++){const k=h;let l=this.text_rows[h].join(" ");d.append(f,k,l)}d.append("</tbody></table></div>");d=d.html();this.wind||(this.wind=UaWindowAdm.create(this.id,"ulaquery_id"),this.setXY(),this.wind.addGroup(g_text),this.wind.drag(),this.wind.setZ(e));this.wind.hide();this.wind.setHtml(d);this.bind()},show:function(d){this.wind&&this.wind.show()},hide:function(){this.wind&&this.wind.hide()},setXY:function(){this.wind.setXY(b,c,-1)},resetXY:function(){this.wind.reset();
this.wind.w.classList.remove("z-index-hover");this.setXY();this.show()},scroll_top:function(){this.wind.w.querySelector("div.text").scrollTop=0},scroll_bottom:function(){const d=this.wind.w.querySelector("div.text");d.scrollTop=d.scrollHeight},unselect:function(){const d=D_M.token_selected.indexOf(a);D_M.token_selected.splice(d,1);this.hide();SelectText.reset();SelectText.update()},hover:function(){const d=UaWindowAdm.getForGroup(g_text);for(const f of d)f.w.classList.remove("z-index-hover");this.wind.w.classList.toggle("z-index-hover")},
getRowsOfFormakey:function(d){const f=[];for(const g of d)1==g.length&&punctuationRegex.test(g)||(d=D_M.findIndnxFormakey(g),f.push(-1<d?D_M.dict_rsl_rows[d]:[g]));FormRows.open(f)},bind:function(){this.wind.w.addEventListener("dblclick",d=>{d.preventDefault();d.stopImmediatePropagation();this.hover()});this.wind.w.querySelector("div.text").addEventListener("click",d=>{d.preventDefault();d.stopImmediatePropagation();d=d.target;if(d.classList.contains("n")){d=d.parentNode;var f=d.querySelector("span.text").innerHTML.split(" ");
this.getRowsOfFormakey(f);f=this.wind.w.querySelectorAll("div.text div.select");for(const g of f)g.classList.remove("select");d.classList.add("select")}});this.wind.w.querySelector("div.menu_wnd").addEventListener("click",d=>{d.preventDefault();d.stopImmediatePropagation();switch(d.target.getAttribute("cmd")){case "close":this.hide();break;case "top":this.scroll_top();break;case "bottom":this.scroll_bottom();break;case "unselect":this.unselect()}})}}}},ContextMgr={names:[],objs:{},createObjs:async function(){var a=
Object.keys(D_M.token_list);let b=0,c=z_context0;for(const e of a)a=this.new(e,b,30,c),this.objs[e]=a,this.names.push(e),b+=200,c+=1},openSelected:function(a){var b=Object.keys(D_M.token_list);let c=D_M.token_selected;0==c.length&&SelectText.open();for(const e of b)b=this.objs[e],-1<c.indexOf(e)?b.open(a):b.hide()},closeAll:function(){const a=Object.values(this.objs);for(const b of a)b.hide()},relocateAll:function(){let a=D_M.token_selected;for(const b of a)this.objs[b].resetXY()},new:function(a,
b,c,e){return{id:`${a}context_id`,name:a,wind:null,context_rows:[],open:function(d){this.context_rows=D_M.findContextRows(d,this.name);this.build(d);this.show()},build:function(d){let f=UaJth();f.append('\n  <div class="menu_wnd" >\n  <ul>\n  <li><a class="tipb" cmd="unselect" href="#">Unselect\n  <span class="tiptextb">Close and Unselect Context</span> </a>\n  </li> \n  <li><a href="#" cmd="close">X</a></li> </ul>\n  </div>\n  <div class="context">\n  ');f.append(`<div class='h'>${a}</div> `);let g=
(l,m)=>`
<div class='rows'>
   <span class='n' >${l}</span>
   <span class='text'>${m}</span>
</div>
`;const h=this.context_rows.length;for(let l=0;l<h;l++){var k=this.context_rows[l];const m=k[0];k=k.slice(1).join(" ");k=k.replace(d,`<span>${d}</span>`);f.append(g,m,k)}f.append("</tbody></table></div>");d=f.html();this.wind||(this.wind=UaWindowAdm.create(this.id,"ulaquery_id"),this.setXY(),this.wind.addGroup(g_context),this.wind.drag(),this.wind.setZ(e));this.wind.hide();this.wind.setHtml(d);this.bind()},show:function(d){this.wind&&this.wind.show()},hide:function(){this.wind&&this.wind.hide()},
setXY:function(){this.wind.setXY(30+b,50+c,-1)},resetXY:function(){this.wind.reset();this.setXY();this.show()},unselect:function(){const d=D_M.token_selected.indexOf(a);D_M.token_selected.splice(d,1);this.hide();SelectText.reset();SelectText.update()},hover:function(){const d=D_M.token_selected;for(const f of d)f!=this.name&&ContextMgr.objs[f].wind.w.classList.remove("z-index-hover");this.wind.w.classList.toggle("z-index-hover")},bind:function(){this.wind.w.addEventListener("dblclick",d=>{d.preventDefault();
d.stopImmediatePropagation();this.hover()});this.wind.w.querySelector("div.menu_wnd").addEventListener("click",d=>{d.preventDefault();d.stopImmediatePropagation();switch(d.target.getAttribute("cmd")){case "close":this.hide();break;case "unselect":this.unselect()}});this.wind.w.querySelector("div.context").addEventListener("click",d=>{d.preventDefault();d.stopImmediatePropagation()})}}}},SelectText={id:"select_text_id",wind:null,open:async function(){this.build();this.show()},toggle:async function(){this.build();
this.wind.toggle()},build:async function(){var a=Object.keys(D_M.token_list);let b=UaJth();b.append('\n  <div class="menu_wnd" >\n  <ul>\n  <li>\n  <a class="tipb" onclick="SelectText.selectAll()"  href="#" >Select\n  <span class="tiptextb">Select All Texts</span> </a>\n  </li>\n  <li>\n  <a class="tipb" onclick="SelectText.unselect()" href="#" >Unselect\n  <span class="tiptextb">Unselect All Texts Selecteds</span>  </a>\n  </li>\n  <li><a onclick="SelectText.hide()"  href="#" >X</a></li>\n  </ul>\n  </div>\n  <div class="select_text">\n  ');
b.append("<div><ul>");b.append('<li class="h"><span>Select Text</span></li> ');for(let c of a)b.append(`<li class="a"><a>${c}</a></li> `);b.append("</ul></div>");a=b.html();this.wind||(this.wind=UaWindowAdm.create(this.id,"ulaquery_id"),this.setXY(),this.wind.addGroup(g_select_text),this.wind.addGroup(g_text),this.wind.drag(),this.wind.setZ(z_select_text));this.wind.setHtml(a);this.bind();this.reset()},show:function(a){this.wind&&this.wind.show()},hide:function(){this.wind&&this.wind.hide()},update:function(){this.wind&&
this.wind.isVisible&&this.wind.show()},setXY:function(){this.wind.setXY(280,30,-1)},resetXY:function(){this.wind.reset();this.setXY();this.show()},bind:function(){this.wind.w.querySelector("div.select_text").addEventListener("click",a=>{a.preventDefault();a.stopImmediatePropagation();a=a.target;a.classList.contains("select")?a.classList.remove("select"):a.classList.add("select");this.select()})},unselectOfName:function(a){const b=D_M.token_selected.indexOf(a);D_M.token_selected.splice(b,1);ContextMgr.objs[a].hide();
this.reset();this.open()},unselect:function(){const a=this.wind.w.querySelectorAll("div.select_text li a");for(let b of a)b.classList.remove("select");D_M.token_selected=[];ContextMgr.closeAll()},select:function(){var a=this.wind.w.querySelectorAll("div.select_text li a");a=Array.from(a).filter(b=>b.classList.contains("select")).map(b=>b.innerHTML);D_M.token_selected=a},selectAll:function(){const a=this.wind.w.querySelectorAll("div.select_text li a");for(let b of a)b.classList.remove("select"),b.classList.add("select");
this.select()},reset:function(){var a=this.wind.w.querySelectorAll("div.select_text li a");a=Array.from(a);for(var b of a)b.classList.remove("select");const c=D_M.token_selected;b=a.filter(e=>-1<c.indexOf(e.innerHTML));for(let e of b)e.classList.add("select");this.select()}},FormRows={id:"formrows_id",wind:null,open:function(a){this.build(a);this.show()},build:function(a){let b=UaJth();b.append('\n<div class="menu_wnd" >\n<ul>\n\n<li>\n<a class="cmd" href="#">?\n</a>\n</li>\n <li>         </li>\n<li><a href="javascript:FormRows.hide()">X</a></li>\n</ul>\n</div>\n<div class="form_rows">\n');
var c=D_M.dict_rsl_heads;b.append("<table><thead><tr>");var e=f=>`<th><span>${f}</span></th>`;b.append(e,"N.");for(var d of c)b.append(e,d.toUpperCase());b.append("</tr></thead><tbody>");e=f=>`<td>${f}</td>`;d=a.length;c=Array(c.length).fill("");c[1]="Not Found";for(let f=0;f<d;f++){const g=a[f];1<g.length?b.append("<tr>"):b.append('<tr class="err" >');b.append(e,f);if(1==g.length){c[0]=g[0];for(const h of c)b.append(e,h)}else for(const h of g)b.append(e,h);b.append("</tr>")}b.append("</tbody></table></div>");
a=b.html();this.wind||(this.wind=UaWindowAdm.create(this.id,"ulaquery_id"),this.setXY(),this.wind.drag(),this.wind.setZ(z_form_rows),this.wind.addGroup(g_form_rows));this.wind.hide();this.wind.setHtml(a);this.bind()},show:function(a){this.wind&&this.wind.show()},hide:function(){this.wind&&this.wind.hide()},setXY:function(){this.wind.setXY(form_rows_left,form_rows_top,-1)},resetXY:function(){this.wind.reset();this.setXY();this.show()},hover:function(){this.wind.w.classList.toggle("z-index-hover-hover")},
bind:function(){}};const nodrag_tds=["input","select","a"],nodrag_cls="nodrag";
function UaDrag(a){return function(b){let c=0,e=0,d=0,f=0;const g=function(k){k=k||window.event;k.preventDefault();c=d-k.clientX;e=f-k.clientY;d=k.clientX;f=k.clientY;b.style.top=b.offsetTop-e+"px";b.style.left=b.offsetLeft-c+"px"},h=function(){document.onmouseup=null;document.onmousemove=null};b.onmousedown=function(k){k=k||window.event;let l=k.target;!(l=l||null)||nodrag_tds.includes(l.tagName.toLowerCase())||l.classList.contains(nodrag_cls)||(k.preventDefault(),d=k.clientX,f=k.clientY,document.onmouseup=
h,document.onmousemove=g)}}(a)};var UaJth=function(){return{rows:[],reset(){this.rows=[];return this},insert(a,...b){a=0==b.length?a:a(...b);this.rows.unshift(a);return this},append(a,...b){a=0==b.length?a:a(...b);this.rows.push(a);return this},text(a){return this.rows.join(a||"")},html(a){return this.text(a).replace(/\s+|\[rn]/g," ")}}};var UaLog={active:!1,wind:null,x:null,y:null,z:null,max_length:2E3,msg_id:"ualogmsg_",new:function(){null==this.wind&&(this.wind=UaWindowAdm.create("ualog_"),this.wind.drag());this.wind.setHtml('\n         <button type="button" onclick="javascript:UaLog.cls();">clear</button>\n         <button type="button" onclick="javascript:UaLog.close();">close</button>\n         <div id="ualogmsg_"></div>');this.wind.setStyle({width:"auto",minWidth:"300px",maxWidth:"400px",height:"auto",textAlign:"center",padding:"2px 2px 2px 2px",
margin:"5px 0 0 0",background:"#111111",color:"#ffffff",fontSize:"15px",fontWeight:"normal",cursor:"move",borderRadius:"9px"});var a=document.getElementById(this.msg_id);const b={width:"auto",textAlign:"left",fontSize:"16px",paddingTop:"2px ",marginTop:"2px",color:"inherit",background:"#444444",maxHeight:"600px",overflow:"auto",scrollbarColor:"#ff4500 #ffffff",scrollbarWidth:"auto"};for(const e in b)a.style[e]=b[e];const c={background:"#555555",color:"#ffffff",padding:"5px 5px 5px 5px",margin:"0 5px 0 5px",
fontSize:"14px",fontWeight:"bold",border:"1px solid #ffffff",borderRadius:"8px"};a=document.querySelectorAll("#ualog_  button");for(const e of a){for(const d in c)e.style[d]=c[d];e.addEventListener("mouseover",d=>{d.target.style.cursor="pointer";d.target.style.color="#000000";d.target.style.background="#aaaaaa"});e.addEventListener("mouseout",d=>{for(const f in c)d.target.style[f]=c[f]})}this.x?this.wind.setXY(this.x,this.y,-1):this.wind.setCenter(-1);this.z&&this.wind.setZ(this.z);return this},setXY:function(a,
b){this.x=a;this.y=b;return this},setZ:function(a){this.z=a;return this},prn_:function(...a){var b=a.join("<br/>");a=document.getElementById(this.msg_id);b=a.innerHTML+b+"<br/>";b.length>this.max_length&&(b=b.slice(-this.max_length));a.innerHTML=b},print:function(...a){alert("UaLog.print");null!=this.wind&&this.active&&this.prn_(...a)},log:function(...a){null!=this.wind&&this.prn_(...a)},log_show:function(...a){null!=this.wind&&(this.active||this.toggle(),this.prn_(...a))},cls:function(){if(null!=
this.wind)return document.getElementById(this.msg_id).innerHTML="",this},close:function(){null!=this.wind&&(this.wind.hide(),this.active=!1)},toggle:function(){null!=this.wind&&(this.active?(this.active=!1,this.wind.hide()):(this.active=!0,this.wind.show()))}};var UaWindowAdm={ws:{},create:function(a,b=null){var c=document.getElementById(a);c||(c=document.createElement("div"),b?document.getElementById(b).appendChild(c):document.body.appendChild(c),c.id=a);c.style.display="none";b=this.newUaWindow(c);return this.ws[a]=b},get:function(a){return this.ws[a]?this.ws[a]:null},close:function(a){this.ws[a]&&this.ws[a].close()},toggle:function(a){this.ws[a]&&this.ws[a].toggle()},hide:function(a){this.ws[a]&&this.ws[a].hide()},showAll:function(){for(let a in this.ws)this.ws[a].show()},
hideAll:function(){for(let a in this.ws)this.ws[a].hide()},closeAll:function(){for(let a in this.ws)this.ws[a].close()},remove:function(a){this.ws[a]&&(document.getElementById(a).remove(),this.ws[a]=null,delete this.ws[a])},removeAll:function(){for(let a in this.ws)this.remove(a);this.ws={}},getForGroup:function(a){return Object.values(this.ws).filter(b=>-1<b.groups.indexOf(a))},newUaWindow:function(a){let b={groups:[],initialize:function(c){this.w=c;this.wy=this.wx="0px";this.isVisible=!1;this.firstShow=
!0;this.wz=this.pos=0},addGroup:function(c){this.groups.push(c);return this},addClassStyle:function(c){this.w.classList.contains(c)||this.w.classList.add(c);return this},removeClassStyle:function(c){this.w.classList.contains(c)&&this.w.classList.remove(c);return this},getWindow:function(){alert("getWindow");return this.w},getId:function(){return this.w.id},getElement:function(){return this.w},setStyle:function(c){for(const e in c)this.w.style[e]=c[e];return this},setHtml:function(c){this.w.innerHTML=
c;return this},getHtml:function(){return this.w.innerHTML},setXY:function(c,e,d){this.wx=c;this.wy=e;d&&(this.pos=d);return this},setCenterY:function(c,e){this.setXY((window.innerWidth-this.w.clientWidth)/2,c,e);return this},setCenter:function(c){this.setXY((window.innerWidth-this.w.clientWidth)/2,(window.innerHeight-this.w.clientHeight)/2,c);return this},linkToId:function(c,e,d,f){c=document.getElementById(c);this.linkToElement(c,e,d,f);return this},linkToElement:function(c,e,d,f){e=c.offsetLeft+
c.offsetWidth+e;c=c.offsetTop+d;0>c&&(c=0);this.setXY(e,c,f);return this},setZ:function(c){this.wz=c;return this},reset:function(){this.firstShow=!0;return this},toggle:function(){this.isVisible?this.hide():this.show();return this},show:function(){if(this.firstShow||1==this.pos||0===this.pos&&!1===this.isVisible)this.w.style.position="absolute",this.w.style.marginLeft=0,this.w.style.marginTop=0,this.w.style.top=this.wy+"px",0<=this.wx?this.w.style.left=this.wx+"px":this.w.style.right=-this.wx+"px",
0<this.wz&&(this.w.style.zIndex=this.wz);this.w.style.display="";this.firstShow=!1;this.isVisible=!0;return this},hide:function(){this.w.style.display="none";this.isVisible=!1;return this},close:function(){this.w.style.display="none";this.w.innerHTML="block";return this},remove:function(){UaWindowAdm.remove(this.w.id);return null},drag:function(){UaDrag(this.w)}};b.initialize(a);return b}};var xlog=console.log;function test(){xlog("test");try{const a=UaWindowAdm.getForGroup("text");for(const b of a)b.hide()}catch(a){alert(a)}}function cmd_close(){confirm("Chiudi Applicazione ?")&&window.open("static/close.html","_self")}function cmd_log_toggle(){UaLog.toggle()}function cmd_log(...a){UaLog.log(...a)}function cmd_log_show(...a){UaLog.log_show(...a)}function wait_start(){const a=document.querySelector("body");a&&a.classList.add("wait")}
function wait_stop(){document.querySelector("body").classList.remove("wait")}function sleep(a){return new Promise(b=>{setTimeout(b,a)})}
const menu=function(){return'\n<div class="menu_bar">\n<ul>\n\n<li class="v"><a href="#">Filter</a>\n<ul class="v">\n\n<li class="h"><a class="tipr" onclick="FLT.open()" href="#">Open\n<span class="tiptextr">Opoen All Window Filter</span></a>\n</li>\n<li class="h"><a class="tipr" onclick="FLT.resetXY()" href="#">Relocate\n<span class="tiptextr">Relocat and Open All Window Filter</span></a>\n</li>\n<li class="h"><a class="tipr" onclick="FLT.show()" href="#">Show\n<span class="tiptextr">Opoen Window Filter Active</span></a>\n</li>\n<li class="h"><a class="tipr" onclick="FLT.hide()" ref="#">Close\n<span class="tiptextr">Close All Windows Filetr</span> </a>\n</li>\n<li class="h"><a class="tipr" onclick="FLT.unselect()" href="#">UnSelect\n<span class="tiptextr">UnSelect All Slect Options Active</span></a>\n</li>\n</ul></li>\n  \n<li class="v"><a class="tipb" onclick="Where.testQuery()" ref="#" >Test Query\n<span class="tiptextb">Display Number of Results</span> </a>\n</li>\n\n<li class="v"><a class="tipb" onclick="SelectText.toggle()" ref="#" >Select Text\n<span class="tiptextb">Select Text For SHow in Context</span> </a>\n</li>\n\n<li class="v"><a href="#">ReusltSet</a>\n<ul class="v">\n<li class="h"><a class="tipr" onclick="FLT.queryRslt()" href="#" >Slection\n<span class="tiptextr">Show Selected ResultSet</span> </a>\n</li>\n<li class="h"><a class="tipr" onclick="ResultSet.openAll()" href="#">All\n<span class="tiptextr">Show All ResultSet</span></a>\n</li>\n</ul></li>\n\n<li class="v"><a href="#">Dictionary</a>\n<ul class="v">\n<li class="h"><a class="tipr" onclick="FLT.queryDict()" href="#">Slection\n<span class="tiptextr">Show Selected Dictionary</span></a>\n</li>\n<li class="h"><a class="tipr" onclick="DictForm.openAll()" href="#">All \n<span class="tiptextr">Show All Dictionary</span></a>\n</li>\n</ul></li>\n\n<li class="v"><a href="#">Context</a>\n<ul class="v">\n<li class="h""><a class="tipr" onclick="ContextMgr.relocateAll()" href="#" >Relocate\n<span class="tiptextr">Relocat and Open All Context Selected</span></a>\n</li>\n<li class="h""><a class="tipr" onclick="ContextMgr.closeAll()" href="#" >Close All\n<span class="tiptextr">Close All Context</span></a>\n</li>\n</ul></li>\n\n<li class="v"><a href="#">Text</a>\n<ul class="v">\n<li class="h""><a class="tipr" onclick="TextMgr.openSelected()" href="#">Open\n<span class="tiptextr">Open Text Selected</span></a>\n</li>\n<li class="h""><a class="tipr" onclick="TextMgr.relocateAll() " href="#"">Relocate\n<span class="tiptextr">Relocat and Open All Text Selected</span></a>\n</li>\n<li class="h""><a class="tipr" onclick="TextMgr.closeAll()" href="#"">Close \n<span class="tiptextr">Close All Text</span></a>\n</li>\n</ul></li>\n\n<li class="v"><a cmd="help" href="#" >Help</a></li>\n<li class="v"><a cmd="test" href="#" >Test</a></li>\n<li class="v"><a cmd="close" href="#" >close</a></li>\n\n</ul>\n</div>\n'.replace(/\s+|\[rn]/g," ")};
let QUERY_ID=null;
var UlaQuery={open:async function(){wait_start();QUERY_ID=document.getElementById("ulaquery_id");this.build();this.bind();await sleep(100);await D_M.load_dict();await D_M.load_tokens();await FormLemma.build();await Sigl.build();await Funct.build();await LangDate.build();await PosMsd.build();await TextMgr.createObjs();await ContextMgr.createObjs();Where.build();wait_stop()},build:function(){const a=menu();QUERY_ID.innerHTML=a},help:async function(){await Help.toggle("static/help1.html")},bind:function(){QUERY_ID.querySelector("div.menu_bar").addEventListener("click",
a=>{a.preventDefault();a.stopImmediatePropagation();switch(a.target.getAttribute("cmd")){case "close":cmd_close();break;case "help":this.help();break;case "test":test()}})}},Help={id:"help_id",top:30,left:50,toggle:async function(a){let b=UaWindowAdm.get(this.id);b||=UaWindowAdm.create(this.id);this.wnd=b;a=await fetch(a,{method:"GET",headers:{"Content-Type":"text/plain;charset=UTF-8"},cache:"default"});a.ok?(a=await a.text(),b.setHtml(`
    <div class="top_bar">
    <a href="javascript:Help.close();">X</a>
    </div>
    ${a}
     `),b.addClassStyle("help"),b.setXY(this.left,this.top).drag(),b.toggle()):alert("ERROR Help()"+a.status)},close:function(){this.wnd.close()}};
